function placeFooterToPageBottom() {
  var footer = $("#footer");
  var pos = footer.position();
  var height = $(window).height();
  height = height - pos.top;
  height = height - footer.height();
  if (height > 0) {
    footer.css({
      'margin-top': height + 'px'
    });
  }
}

$(window).resize(function() {
  placeFooterToPageBottom();
});

$(function() {
  $("#expand-menu").click(function() {
    $(this).slideUp(400);
    $("#menu").removeClass("hide-for-small-only");
    $("#menu").hide();
    $("#menu").slideToggle(400);
  });

  $(".remove").click(function() {
    var deletedRow = $(this).closest("tr");
    var id = deletedRow.attr("id");

    if($(this).hasClass("application")) {
      var path = "{{ path('remove_application') }}";
    }
    if($(this).hasClass("job")) {
      var path = "{{ path('remove_job') }}";
    }

    $.post(path, {id: id}, function(result){
      deletedRow.fadeTo(400, 0, function() {
        $(this).remove();
        placeFooterToPageBottom();
      });
    });
  });

  $(".invite").click(function() {
    var id = $(this).closest("tr").attr("id");
    var tableField = $(this).closest("td");
    var path = "{{ path('invite') }}";

    $.post(path, {id: id}, function(result){
      tableField.html("&#10003;");
    });
  });

  $("textarea").richText({
    underline: false,
    leftAlign: false,
    centerAlign: false,
    rightAlign: false,
    justify: false,
    ol: false,
    ul: false,
    heading: false,
    fonts: false,
    fontColor: false,
    fontSize: false,
    imageUpload: false,
    fileUpload: false,
    videoEmbed: false,
    urls: false,
    table: false,
    removeStyles: false,
    code: false,
  });

  $.extend(true, $.fn.dataTable.defaults, {
    "language": {
      "url": "//cdn.datatables.net/plug-ins/1.10.19/i18n/Dutch.json"
    }
  });

  $("#employer-jobs").DataTable( {
    "searching": false,
    "info": false,
    "paging": false,
    "stripeClasses": []
  });

  $("#my-jobs, #my-applications").DataTable( {
    "columnDefs": [ {
      "targets": [4],
      "orderable": false
    }],
    "searching": false,
    "info": false,
    "paging": false,
    "stripeClasses": []
  });

  $("#job-applications").DataTable( {
    "searching": false,
    "stripeClasses": []
  });

  placeFooterToPageBottom();

  //---scripts for Simple Ajax Uploader---//
  function escapeTags( str ) {
    return String( str ).replace( /&/g, '&amp;' )
                        .replace( /"/g, '&quot;' )
                        .replace( /'/g, '&#39;' )
                        .replace( /</g, '&lt;' )
                        .replace( />/g, '&gt;' );
  }

  var btn = $('#upload-cv'),
      msgBox = $('#msgBox'),
      input = $("#input-cv");

  var uploader = new ss.SimpleUpload({
        button: btn,
        url: "{{ path('upload') }}",
        name: 'uploadfile',
        multipart: true,
        responseType: 'json',
        onSubmit: function() {
          msgBox.html('');
          btn.html('uploaden...');
        },
        onComplete: function( filename, response ) {
          btn.html('<i class="fas fa-file-upload"></i> Upload CV');

          if ( !response ) {
            msgBox.html('Kan bestand niet uploaden');
            return;
          }
          if ( response.success === true ) {
            msgBox.html('<strong>' + escapeTags( filename ) + '</strong><br>' +
            'Sla je profiel op om dit bestand te gebruiken.');
            input.val(escapeTags( filename ));
          } else {
            if ( response.msg )  {
              msgBox.html(escapeTags( response.msg ));
            } else {
              msgBox.html('Fout opgetreden, upload mislukt.');
            }
          }
        },
        onError: function() {
          msgBox.html('Kan bestand niet uploaden');
        }
  	});
});
